<!DOCTYPE html>
<html lang="bn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶Æ‡¶æ‡¶∏‡ßç‡¶ü‡¶æ‡¶∞‡¶∞‡ßã‡¶≤ - ‡¶Ø‡¶æ‡¶§‡¶æ‡ßü‡¶æ‡¶§ ‡¶≠‡¶æ‡¶§‡¶æ</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="../authentication.js"></script>
    <style>
        @font-face {
            font-family: 'NikoshBAN ';
            src: local('Nikosh');
        }

        @font-face {
            font-family: 'NikoshBAN';
            src: local('NikoshBAN');
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nikosh', 'SolaimanLipi', Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .no-print {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn {
            padding: 10px 30px;
            margin: 0 5px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 5px 0;
        }

        th,
        td {
            border: 1px solid black;
            padding: 4px;
            text-align: center;
            vertical-align: middle;
            font-size: 10pt;
            line-height: 1.2;
        }

        .text-left {
            text-align: left;
        }

        .header-text {
            text-align: center;
            margin-bottom: 10px;
        }

        .header-text h1 {
            font-size: 18pt;
            margin-bottom: 2px;
        }

        .header-text h2 {
            font-size: 14pt;
            margin-bottom: 2px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 12pt;
            font-weight: bold;
        }

        .signature-cell {
            width: 3cm;
            height: 2cm;
            min-width: 3cm;
            min-height: 2cm;
        }

        .revenue-cell {
            width: 2.5cm;
            height: 2cm;
            min-width: 2.5cm;
            min-height: 2cm;
        }

        .sl-cell {
            width: 40px;
        }

        .amount-cell {
            width: 80px;
        }

        .designation-cell {
            width: 120px;
        }

        .name-cell {
            width: 4.2cm;
            min-width: 4.2cm;
        }

        .loading {
            text-align: center;
            padding: 50px;
        }

        .error {
            text-align: center;
            padding: 50px;
            color: red;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                padding: 0;
                max-width: none;
                width: 100%;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
            }

            .signature-cell {
                width: 3cm !important;
                height: 2cm !important;
            }

            .revenue-cell {
                width: 2.5cm !important;
                height: 2cm !important;
            }

            table {
                page-break-inside: auto;
            }

            tr {
                page-break-inside: avoid;
                page-break-after: auto;
            }
        }
    </style>
</head>

<body>
    <div class="no-print">
        <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button class="btn btn-primary" onclick="window.history.back()">‚¨Ö ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>
    </div>

    <div class="container">
        <div id="masterRollContent">
            <div class="loading">
                <h2>‚è≥ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</h2>
            </div>
        </div>
    </div>

    <script>
        // Load all data on page load
        window.addEventListener('DOMContentLoaded', async () => {
            checkAuth();
            try {
                const data = await loadMasterRollData();
                renderMasterRoll(data);
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('masterRollContent').innerHTML = `
                    <div class="error">
                        <h2>‚ùå ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá‡¶õ‡ßá</h2>
                        <p>${error.message}</p>
                        <button class="btn btn-primary" onclick="window.location.reload()">‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>
                `;
            }
        });

        async function loadMasterRollData() {
            if (!window.supabaseClient) {
                throw new Error('Supabase client not initialized');
            }

            // Fetch data in pages to avoid the default 1000-row cap
            async function fetchAllRows(table, selectColumns, orderColumn) {
                const pageSize = 1000;
                let from = 0;
                let allRows = [];
                while (true) {
                    let query = window.supabaseClient
                        .from(table)
                        .select(selectColumns)
                        .range(from, from + pageSize - 1);
                    if (orderColumn) {
                        query = query.order(orderColumn, { ascending: true });
                    }
                    const { data, error } = await query;
                    if (error) throw error;
                    if (!data || data.length === 0) break;
                    allRows = allRows.concat(data);
                    if (data.length < pageSize) break;
                    from += pageSize;
                }
                return allRows;
            }

            // Fetch all assignments
            const assignments = await fetchAllRows('centre_assignments', '*', 'vote_centre_code');
            if (!assignments || assignments.length === 0) {
                throw new Error('‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∏‡¶æ‡¶á‡¶®‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡¶Ø‡¶º‡¶æ ‡¶Ø‡¶æ‡¶Ø‡¶º‡¶®‡¶ø‡•§');
            }

            // Fetch centre details
            const centres = await fetchAllRows('vote_centre', '*', 'vote_centre_code');

            const centreDetailsMap = new Map(centres.map(c => [String(c.vote_centre_code), c]));

            // Fetch officer details for name, designation, workplace(address), mobile
            const presidingIds = assignments.filter(a => a.officer_type === 'presiding').map(a => a.officer_iid);
            const assPresidingIds = assignments.filter(a => a.officer_type === 'ass_presiding').map(a => a.officer_iid);
            const pollingIds = assignments.filter(a => a.officer_type === 'polling').map(a => a.officer_iid);

            // Helper function to fetch data in chunks (Supabase .in() has a limit around 1000)
            async function fetchInChunks(table, idColumn, ids) {
                if (!ids.length) return [];
                const chunkSize = 1000;
                const results = [];
                for (let i = 0; i < ids.length; i += chunkSize) {
                    const chunk = ids.slice(i, i + chunkSize);
                    const { data, error } = await window.supabaseClient
                        .from(table)
                        .select('*')
                        .in(idColumn, chunk);
                    if (error) throw error;
                    results.push(...(data || []));
                }
                return results;
            }

            const [pData, apData, poData] = await Promise.all([
                fetchInChunks('presiding_list', 'presiding_iid', presidingIds),
                fetchInChunks('ass_presiding_list', 'ass_presiding_iid', assPresidingIds),
                fetchInChunks('polling_list', 'polling_iid', pollingIds)
            ]);

            const officerDetails = {
                presiding: new Map(pData.map(o => [String(o.presiding_iid), o])),
                ass_presiding: new Map(apData.map(o => [String(o.ass_presiding_iid), o])),
                polling: new Map(poData.map(o => [String(o.polling_iid), o]))
            };

            // Debug counts
            console.log('Loaded centres:', centres ? centres.length : 0, 'assignments:', assignments ? assignments.length : 0);

            // Initialize groups from all centres so centres without assignments are also shown
            const groups = new Map();
            centres.forEach(c => {
                const code = String(c.vote_centre_code);
                groups.set(code, {
                    centre: c,
                    officers: []
                });
            });

            // Add assignments into the appropriate centre group
            assignments.forEach(a => {
                const code = String(a.vote_centre_code || '');
                if (!code) {
                    console.warn('Assignment without vote_centre_code:', a);
                    return;
                }
                if (!groups.has(code)) {
                    // If centre isn't in centres list for some reason, create a fallback entry
                    groups.set(code, {
                        centre: centreDetailsMap.get(code) || { vote_centre_code: code, vote_centre_name: 'N/A' },
                        officers: []
                    });
                }
                const bundle = groups.get(code);
                const typeMap = officerDetails[a.officer_type];
                const details = typeMap ? typeMap.get(String(a.officer_iid)) : null;
                bundle.officers.push({
                    ...a,
                    name: details ? (details.presiding_name || details.ass_presiding_name || details.polling_name) : (a.officer_name || a.name || ''),
                    mobile: details ? details.mobile_number : '',
                    workplace: details ? details.address : '',
                    designation_original: a.officer_designation
                });
            });

            // Log centres with no assignments (useful for debugging)
            const centresWithNoAssignments = Array.from(groups.values()).filter(g => g.officers.length === 0).map(g => g.centre.vote_centre_code);
            console.log('Centres with no assignments:', centresWithNoAssignments.length, centresWithNoAssignments.slice(0, 50));

            // Sort officers in each centre: Presiding, then Assistant Presiding, then Polling
            groups.forEach(bundle => {
                bundle.officers.sort((a, b) => {
                    const order = { 'presiding': 1, 'ass_presiding': 2, 'polling': 3 };
                    if (order[a.officer_type] !== order[b.officer_type]) {
                        return order[a.officer_type] - order[b.officer_type];
                    }
                    if (a.booth_number !== b.booth_number) {
                        return (a.booth_number || 0) - (b.booth_number || 0);
                    }
                    return (a.person_number || 0) - (b.person_number || 0);
                });
            });

            const groupsArray = Array.from(groups.values());
            return groupsArray.sort((a, b) => {
                const codeA = parseInt(a.centre.vote_centre_code) || 0;
                const codeB = parseInt(b.centre.vote_centre_code) || 0;
                return codeA - codeB;
            });
        }

        function toBengaliNumber(n) {
            if (n === null || n === undefined) return '';
            const bengaliDigits = '‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ';
            return String(n).replace(/\d/g, d => bengaliDigits[Number(d)]);
        }

        function renderMasterRoll(allData) {
            const container = document.getElementById('masterRollContent');
            let html = '';

            allData.forEach((bundle, index) => {
                const { centre, officers } = bundle;
                const totalBooths = (Number(centre.voter_both_male) || 0) + (Number(centre.voter_both_female) || 0);

                // Calculate total net amount for the center
                const totalNet = officers.reduce((sum, off) => {
                    let allowance = 0;
                    if (off.officer_type === 'presiding') allowance = 8000;
                    else if (off.officer_type === 'ass_presiding') allowance = 6000;
                    else if (off.officer_type === 'polling') allowance = 4000;
                    const tax = allowance * 0.1;
                    const travelAllowance = 1000;
                    return sum + ((allowance - tax) + travelAllowance);
                }, 0);

                html += `
                    <div class="page ${index < allData.length - 1 ? 'page-break' : ''}">
                        <div style="font-size: 12pt; margin-bottom: 20px; font-family: 'NikoshBAN', sans-serif;">
                            <div style="text-align: right; margin-bottom: 5px;">‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞ ‡¶®‡¶Ç-........................................</div>
                            <div style="text-align: center; text-decoration: underline; font-weight: bold; margin-bottom: 15px; font-size: 14pt;">‡¶§‡ßç‡¶∞‡ßü‡ßã‡¶¶‡¶∂ ‡¶ú‡¶æ‡¶§‡ßÄ‡ßü ‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡ß®‡ß¶‡ß®‡ß¨ ‡¶â‡¶™‡¶≤‡¶ï‡ßç‡¶∑‡ßá ‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞</div>
                            
                            <div style="line-height: 1.5;">
                                <div>‡ßß‡•§ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡¶ø ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ì ‡¶®‡¶æ‡¶Æ: ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ - ‡ß®‡ß¨‡ß¨ ‡¶´‡ßá‡¶®‡ßÄ-‡ß®</div>
                                <div>‡ß®‡•§ ‡¶≠‡ßã‡¶ü ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ: ${toBengaliNumber(centre.vote_centre_code)} - ${centre.vote_centre_name || ''}</div>
                                <div>‡ß©‡•§ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ‡ßß‡ß®/‡ß¶‡ß®/‡ß®‡ß¶‡ß®‡ß¨ ‡¶ñ‡ßç‡¶∞‡¶ø.</div>
                                <div>‡ß™‡•§ ‡¶Ö‡¶∞‡ßç‡¶•‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£: ${toBengaliNumber(totalNet)}/- (‡¶ï‡¶•‡¶æ‡ßü- ${convertNumberToBanglaWords(totalNet)} ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞)</div>
                                <div style="text-align: justify;">‡ß´‡•§ ‡¶Ø‡ßá ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶∞‡ßç‡¶• ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶§‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£: ‡¶≠‡ßã‡¶ü‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá ‡¶≠‡ßã‡¶ü ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡ßü‡ßã‡¶ú‡¶ø‡¶§ ‡¶ï‡¶∞‡ßç‡¶Æ‡¶ï‡¶∞‡ßç‡¶§‡¶æ‡¶¶‡ßá‡¶∞ ‡¶∏‡¶Æ‡ßç‡¶Æ‡¶æ‡¶®‡ßÄ ‡¶≠‡¶æ‡¶§‡¶æ ‡¶¨‡¶æ‡¶¨‡¶¶ (‡¶™‡ßç‡¶∞‡¶ø‡¶ú‡¶æ‡¶á‡¶°‡¶ø‡¶Ç ‡¶Ö‡¶´‡¶ø‡¶∏‡¶æ‡¶∞- ‡ß™‡ß¶‡ß¶‡ß¶√ó‡ß®=‡ßÆ,‡ß¶‡ß¶‡ß¶; ‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡ßç‡¶∞‡¶ø‡¶ú‡¶æ‡¶á‡¶°‡¶ø‡¶Ç ‡¶Ö‡¶´‡¶ø‡¶∏‡¶æ‡¶∞-‡ß©‡ß¶‡ß¶‡ß¶√ó‡ß®=‡ß¨,‡ß¶‡ß¶‡ß¶ ; ‡¶™‡ßá‡¶æ‡¶≤‡¶ø‡¶Ç ‡¶Ö‡¶´‡¶ø‡¶∏‡¶æ‡¶∞ ‡ß®‡ß¶‡ß¶‡ß¶√ó‡ß®=‡ß™,‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶π‡¶æ‡¶∞‡ßá ‡¶è‡¶¨‡¶Ç ‡¶™‡ßç‡¶∞‡¶§‡¶ø‡¶ú‡¶® ‡ßß‡ß¶‡ß¶‡ß¶ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶π‡¶æ‡¶∞‡ßá ‡¶Ø‡¶æ‡¶§‡¶æ‡ßü‡¶æ‡¶§ ‡¶≠‡¶æ‡¶§‡¶æ‡•§)</div>
                            </div>
                        </div>

                        <table>
                            <thead>
                                <tr>
                                    <th colspan="9" style="text-align: right; padding: 5px; border: none; font-size: 11pt;">
                                        ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶®‡¶Ç - ${toBengaliNumber(centre.vote_centre_code)}
                                    </th>
                                </tr>
                                <tr>
                                    <th class="sl-cell">‡¶ï‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï ‡¶®‡¶Ç</th>
                                    <th class="name-cell">‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶Æ‡ßã‡¶¨‡¶æ‡¶á‡¶≤ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞</th>
                                    <th class="designation-cell">‡¶™‡¶¶‡¶¨‡ßÄ</th>
                                    <th class="amount-cell">‡¶™‡ßç‡¶∞‡¶¶‡¶§‡ßç‡¶§ ‡¶Ö‡¶∞‡ßç‡¶•‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶®</th>
                                    <th class="amount-cell">‡¶â‡ßé‡¶∏ ‡¶ï‡¶∞ ‡¶ï‡¶∞‡ßç‡¶§‡¶® ‡ßß‡ß¶%</th>
                                    <th class="amount-cell">‡¶Ø‡¶æ‡¶§‡¶æ‡ßü‡¶æ‡¶§ ‡¶≠‡¶æ‡¶§‡¶æ</th>
                                    <th class="amount-cell">‡¶®‡ßÄ‡¶ü ‡¶ü‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶®</th>
                                    <th class="signature-cell">‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞</th>
                                    <th class="revenue-cell">‡¶∞‡ßá‡¶≠‡¶ø‡¶®‡¶ø‡¶â</th>
                                </tr>
                            </thead>
                            <tbody>
                `;

                officers.forEach((off, i) => {
                    let typeBn = '';
                    let allowance = 0;
                    if (off.officer_type === 'presiding') {
                        typeBn = '‡¶™‡ßç‡¶∞‡¶ø‡¶ú‡¶æ‡¶á‡¶°‡¶ø‡¶Ç';
                        allowance = 8000;
                    } else if (off.officer_type === 'ass_presiding') {
                        typeBn = '‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡ßÄ ‡¶™‡ßç‡¶∞‡¶ø‡¶ú‡¶æ‡¶á‡¶°‡¶ø‡¶Ç';
                        allowance = 6000;
                    } else if (off.officer_type === 'polling') {
                        typeBn = '‡¶™‡ßã‡¶≤‡¶ø‡¶Ç';
                        allowance = 4000;
                    }

                    const tax = allowance * 0.1;
                    const travelAllowance = 1000;
                    const netAmount = (allowance - tax) + travelAllowance;

                    html += `
                        <tr>
                            <td>${toBengaliNumber(i + 1)}</td>
                            <td class="text-left name-cell">
                                ${toBengaliNumber(off.name || '')}
                            </td>
                            <td>${typeBn}</td>
                            <td>${toBengaliNumber(allowance)}/-</td>
                            <td>${toBengaliNumber(tax)}/-</td>
                            <td>${toBengaliNumber(travelAllowance)}/-</td>
                            <td>${toBengaliNumber(netAmount)}/-</td>
                            <td class="signature-cell"></td>
                            <td class="revenue-cell"></td>
                        </tr>
                    `;
                });

                html += `
                            </tbody>
                        </table>
                        <div style="margin-top: 50px; display: flex; justify-content: space-between; font-weight: bold; margin-bottom: 30px;">
                             <span>‡¶ï‡¶∞‡ßç‡¶Æ‡¶ï‡¶∞‡ßç‡¶§‡¶æ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶∏‡ßÄ‡¶≤</span>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function convertNumberToBanglaWords(amount) {
            const digits = ['‡¶∂‡ßÇ‡¶®‡ßç‡¶Ø', '‡¶è‡¶ï', '‡¶¶‡ßÅ‡¶á', '‡¶§‡¶ø‡¶®', '‡¶ö‡¶æ‡¶∞', '‡¶™‡¶æ‡¶Å‡¶ö', '‡¶õ‡ßü', '‡¶∏‡¶æ‡¶§', '‡¶Ü‡¶ü', '‡¶®‡ßü'];
            const words = {
                0: '',
                1: '‡¶è‡¶ï',
                2: '‡¶¶‡ßÅ‡¶á',
                3: '‡¶§‡¶ø‡¶®',
                4: '‡¶ö‡¶æ‡¶∞',
                5: '‡¶™‡¶æ‡¶Å‡¶ö',
                6: '‡¶õ‡ßü',
                7: '‡¶∏‡¶æ‡¶§',
                8: '‡¶Ü‡¶ü',
                9: '‡¶®‡ßü',
                10: '‡¶¶‡¶∂',
                11: '‡¶è‡¶ó‡¶æ‡¶∞‡ßã',
                12: '‡¶¨‡¶æ‡¶∞‡ßã',
                13: '‡¶§‡ßá‡¶∞‡ßã',
                14: '‡¶ö‡ßå‡¶¶‡ßç‡¶¶',
                15: '‡¶™‡¶®‡ßá‡¶∞‡ßã',
                16: '‡¶∑‡ßã‡¶≤',
                17: '‡¶∏‡¶§‡ßá‡¶∞‡ßã',
                18: '‡¶Ü‡¶†‡¶æ‡¶∞‡ßã',
                19: '‡¶ä‡¶®‡¶ø‡¶∂',
                20: '‡¶¨‡¶ø‡¶∂',
                21: '‡¶è‡¶ï‡ßÅ‡¶∂',
                22: '‡¶¨‡¶æ‡¶á‡¶∂',
                23: '‡¶§‡ßá‡¶á‡¶∂',
                24: '‡¶ö‡¶¨‡ßç‡¶¨‡¶ø‡¶∂',
                25: '‡¶™‡¶Å‡¶ö‡¶ø‡¶∂',
                26: '‡¶õ‡¶æ‡¶¨‡ßç‡¶¨‡¶ø‡¶∂',
                27: '‡¶æ‡¶§‡¶æ‡¶∂',
                28: '‡¶Ü‡¶†‡¶æ‡¶∂',
                29: '‡¶ä‡¶®‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                30: '‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                31: '‡¶è‡¶ï‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                32: '‡¶¨‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                33: '‡¶§‡ßá‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                34: '‡¶ö‡ßå‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                35: '‡¶™‡ßü‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                36: '‡¶õ‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                37: '‡¶∏‡¶æ‡¶Å‡¶á‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                38: '‡¶Ü‡¶ü‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                39: '‡¶ä‡¶®‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                40: '‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                41: '‡¶è‡¶ï‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                42: '‡¶¨‡¶ø‡ßü‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                43: '‡¶§‡ßá‡¶§‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                44: '‡¶ö‡ßÅ‡ßü‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                45: '‡¶™‡ßü‡¶§‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                46: '‡¶õ‡ßá‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                47: '‡¶∏‡¶æ‡¶§‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                48: '‡¶Ü‡¶ü‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                49: '‡¶ä‡¶®‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂',
                50: '‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂',
                51: '‡¶è‡¶ï‡¶æ‡¶®‡ßç‡¶®',
                52: '‡¶¨‡¶æ‡ßü‡¶æ‡¶®‡ßç‡¶®',
                53: '‡¶§‡¶ø‡¶™‡ßç‡¶™‡¶æ‡¶®‡ßç‡¶®',
                54: '‡¶ö‡ßÅ‡ßü‡¶æ‡¶®‡ßç‡¶®',
                55: '‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶®‡ßç‡¶®',
                56: '‡¶õ‡¶æ‡¶™‡ßç‡¶™‡¶æ‡¶®‡ßç‡¶®',
                57: '‡¶∏‡¶æ‡¶§‡¶æ‡¶®‡ßç‡¶®',
                58: '‡¶Ü‡¶ü‡¶æ‡¶®‡ßç‡¶®',
                59: '‡¶ä‡¶®‡¶∑‡¶æ‡¶ü',
                60: '‡¶∑‡¶æ‡¶ü',
                61: '‡¶è‡¶ï‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                62: '‡¶¨‡¶æ‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                63: '‡¶§‡ßá‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                64: '‡¶ö‡ßå‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                65: '‡¶™‡ßü‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                66: '‡¶õ‡ßá‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                67: '‡¶∏‡¶æ‡¶§‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                68: '‡¶Ü‡¶ü‡¶∑‡¶ü‡ßç‡¶ü‡¶ø',
                69: '‡¶ä‡¶®‡¶∏‡¶§‡ßç‡¶§‡¶∞',
                70: '‡¶∏‡¶§‡ßç‡¶§‡¶∞',
                71: '‡¶è‡¶ï‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                72: '‡¶¨‡¶æ‡¶π‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                73: '‡¶§‡¶ø‡ßü‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                74: '‡¶ö‡ßÅ‡ßü‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                75: '‡¶™‡¶Å‡¶ö‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                76: '‡¶õ‡¶ø‡ßü‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                77: '‡¶∏‡¶æ‡¶§‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                78: '‡¶Ü‡¶ü‡¶æ‡¶§‡ßç‡¶§‡¶∞',
                79: '‡¶ä‡¶®‡¶Ü‡¶∂‡¶ø',
                80: '‡¶Ü‡¶∂‡¶ø',
                81: '‡¶è‡¶ï‡¶æ‡¶∂‡¶ø',
                82: '‡¶¨‡¶ø‡¶∞‡¶æ‡¶∂‡¶ø',
                83: '‡¶§‡¶ø‡¶∞‡¶æ‡¶∂‡¶ø',
                84: '‡¶ö‡ßÅ‡¶∞‡¶æ‡¶∂‡¶ø',
                85: '‡¶™‡¶Å‡¶ö‡¶æ‡¶∂‡¶ø',
                86: '‡¶õ‡¶ø‡ßü‡¶æ‡¶∂‡¶ø',
                87: '‡¶∏‡¶æ‡¶§‡¶æ‡¶∂‡¶ø',
                88: '‡¶Ü‡¶ü‡¶æ‡¶∂‡¶ø',
                89: '‡¶ä‡¶®‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                90: '‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                91: '‡¶è‡¶ï‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                92: '‡¶¨‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                93: '‡¶§‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                94: '‡¶ö‡ßÅ‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                95: '‡¶™‡¶Å‡¶ö‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                96: '‡¶õ‡¶ø‡ßü‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                97: '‡¶∏‡¶æ‡¶§‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                98: '‡¶Ü‡¶ü‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                99: '‡¶®‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á'
            };

            const convertLessThan100 = (n) => {
                return words[Number(n)];
            };

            const convert = (n) => {
                n = Number(n);
                if (n === 0) return '';
                if (n < 100) return convertLessThan100(n);
                if (n < 1000) {
                    const hundreds = Math.floor(n / 100);
                    const remainder = n % 100;
                    return (hundreds ? words[hundreds] + ' ‡¶∂‡¶§ ' : '') + (remainder ? convertLessThan100(remainder) : '');
                }
                if (n < 100000) {
                    const thousands = Math.floor(n / 1000);
                    const remainder = n % 1000;
                    return (thousands ? convert(thousands) + ' ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ ' : '') + (remainder ? convert(remainder) : '');
                }
                if (n < 10000000) {
                    const lakhs = Math.floor(n / 100000);
                    const remainder = n % 100000;
                    return (lakhs ? convert(lakhs) + ' ‡¶≤‡¶ï‡ßç‡¶∑ ' : '') + (remainder ? convert(remainder) : '');
                }
                const crores = Math.floor(n / 10000000);
                const remainder = n % 10000000;
                return (crores ? convert(crores) + ' ‡¶ï‡ßã‡¶ü‡¶ø ' : '') + (remainder ? convert(remainder) : '');
            };

            return convert(amount).trim();
        }
    </script>
</body>

</html>