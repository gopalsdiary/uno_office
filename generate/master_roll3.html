<!DOCTYPE html>
<html lang="bn">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡¶ï‡¶æ‡¶ö‡¶æ ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="../authentication.js"></script>
    <style>
        @font-face {
            font-family: 'NikoshBAN ';
            src: local('Nikosh');
        }

        @font-face {
            font-family: 'NikoshBAN';
            src: local('NikoshBAN');
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Nikosh', 'SolaimanLipi', Arial, sans-serif;
            background: #f5f5f5;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
        }

        .no-print {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn {
            padding: 10px 30px;
            margin: 0 5px;
            font-size: 16px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn:hover {
            opacity: 0.9;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            margin: 5px 0;
        }

        th,
        td {
            border: 1px solid black;
            padding: 4px;
            text-align: center;
            vertical-align: middle;
            font-size: 11pt;
            line-height: 1.2;
        }

        .text-left {
            text-align: left;
        }

        .header-text {
            text-align: center;
            margin-bottom: 10px;
        }

        .header-text h1 {
            font-size: 18pt;
            margin-bottom: 2px;
        }

        .header-text h2 {
            font-size: 14pt;
            margin-bottom: 2px;
        }

        .info-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 12pt;
            font-weight: bold;
        }

        .signature-cell {
            width: 3cm;
            height: 2cm;
            min-width: 3cm;
            min-height: 2cm;
        }

        .revenue-cell {
            width: 2.5cm;
            height: 2cm;
            min-width: 2.5cm;
            min-height: 2cm;
        }

        .sl-cell {
            width: 40px;
        }

        .amount-cell {
            width: 80px;
        }

        .designation-cell {
            width: 120px;
        }

        .loading {
            text-align: center;
            padding: 50px;
        }

        .error {
            text-align: center;
            padding: 50px;
            color: red;
        }

        @page {
            size: A4;
            margin: 0.2in;
        }

        @media print {
            body {
                background: white;
                padding: 0;
            }

            .container {
                box-shadow: none;
                padding: 0;
                max-width: none;
                width: 100%;
            }

            .no-print {
                display: none !important;
            }

            .page-break {
                page-break-after: always;
            }

            .voucher {
                page-break-inside: avoid;
            }
        }

        .separator {
            border-top: 2px dashed #000;
            margin: 40px 0;
            position: relative;
        }

        .separator:after {
            content: '‚úÇ';
            position: absolute;
            top: -12px;
            left: 0;
            font-size: 16pt;
        }
    </style>
</head>

<body>
    <div class="no-print">
        <button class="btn btn-primary" onclick="window.print()">üñ®Ô∏è ‡¶™‡ßç‡¶∞‡¶ø‡¶®‡ßç‡¶ü ‡¶ï‡¶∞‡ßÅ‡¶®</button>
        <button class="btn btn-primary" onclick="window.history.back()">‚¨Ö ‡¶´‡¶ø‡¶∞‡ßá ‡¶Ø‡¶æ‡¶®</button>
    </div>

    <div class="container">
        <div id="masterRollContent">
            <div class="loading">
                <h2>‚è≥ ‡¶°‡¶æ‡¶ü‡¶æ ‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</h2>
            </div>
        </div>
    </div>

    <script>
        // Load all data on page load
        window.addEventListener('DOMContentLoaded', async () => {
            checkAuth();
            try {
                const data = await loadMasterRollData();
                renderMasterRoll(data);
            } catch (error) {
                console.error('Error loading data:', error);
                document.getElementById('masterRollContent').innerHTML = `
                    <div class="error">
                        <h2>‚ùå ‡¶§‡ßç‡¶∞‡ßÅ‡¶ü‡¶ø ‡¶¶‡ßá‡¶ñ‡¶æ ‡¶¶‡¶ø‡ßü‡ßá‡¶õ‡ßá</h2>
                        <p>${error.message}</p>
                        <button class="btn btn-primary" onclick="window.location.reload()">‡¶Ü‡¶¨‡¶æ‡¶∞ ‡¶ö‡ßá‡¶∑‡ßç‡¶ü‡¶æ ‡¶ï‡¶∞‡ßÅ‡¶®</button>
                    </div>
                `;
            }
        });

        async function loadMasterRollData() {
            if (!window.supabaseClient) {
                throw new Error('Supabase client not initialized');
            }

            // Fetch all assignments
            const { data: assignments, error: assignError } = await window.supabaseClient
                .from('centre_assignments')
                .select('*')
                .order('vote_centre_code', { ascending: true });

            if (assignError) throw assignError;
            if (!assignments || assignments.length === 0) {
                throw new Error('‡¶ï‡ßã‡¶®‡ßã ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶∏‡¶æ‡¶á‡¶®‡¶Æ‡ßá‡¶®‡ßç‡¶ü ‡¶™‡¶æ‡¶ì‡ßü‡¶æ ‡¶Ø‡¶æ‡ßü‡¶®‡¶ø‡•§');
            }

            // Fetch centre details
            const { data: centres, error: centreError } = await window.supabaseClient
                .from('vote_centre')
                .select('*');

            if (centreError) throw centreError;

            const centreDetailsMap = new Map(centres.map(c => [String(c.vote_centre_code), c]));

            // Fetch officer details for name, designation, workplace(address), mobile
            const presidingIds = assignments.filter(a => a.officer_type === 'presiding').map(a => a.officer_iid);
            const assPresidingIds = assignments.filter(a => a.officer_type === 'ass_presiding').map(a => a.officer_iid);
            const pollingIds = assignments.filter(a => a.officer_type === 'polling').map(a => a.officer_iid);

            const [pRes, apRes, poRes] = await Promise.all([
                presidingIds.length ? window.supabaseClient.from('presiding_list').select('presiding_iid, presiding_name, mobile_number, address').in('presiding_iid', presidingIds) : { data: [] },
                assPresidingIds.length ? window.supabaseClient.from('ass_presiding_list').select('ass_presiding_iid, ass_presiding_name, mobile_number, address').in('ass_presiding_iid', assPresidingIds) : { data: [] },
                pollingIds.length ? window.supabaseClient.from('polling_list').select('polling_iid, polling_name, mobile_number, address').in('polling_iid', pollingIds) : { data: [] }
            ]);

            const officerDetails = {
                presiding: new Map(pRes.data.map(o => [o.presiding_iid, o])),
                ass_presiding: new Map(apRes.data.map(o => [o.ass_presiding_iid, o])),
                polling: new Map(poRes.data.map(o => [o.polling_iid, o]))
            };

            // Debug counts
            console.log('Loaded centres:', centres ? centres.length : 0, 'assignments:', assignments ? assignments.length : 0);

            // Initialize groups from all centres so centres without assignments are also shown
            const groups = new Map();
            centres.forEach(c => {
                const code = String(c.vote_centre_code);
                groups.set(code, {
                    centre: c,
                    officers: []
                });
            });

            // Add assignments into the appropriate centre group
            assignments.forEach(a => {
                const code = String(a.vote_centre_code || '');
                if (!code) {
                    console.warn('Assignment without vote_centre_code:', a);
                    return;
                }
                if (!groups.has(code)) {
                    // If centre isn't in centres list for some reason, create a fallback entry
                    groups.set(code, {
                        centre: centreDetailsMap.get(code) || { vote_centre_code: code, vote_centre_name: 'N/A' },
                        officers: []
                    });
                }
                const bundle = groups.get(code);
                const details = officerDetails[a.officer_type].get(a.officer_iid);
                bundle.officers.push({
                    ...a,
                    name: details ? (details.presiding_name || details.ass_presiding_name || details.polling_name) : a.officer_name,
                    mobile: details ? details.mobile_number : '',
                    workplace: details ? details.address : '',
                    designation_original: a.officer_designation
                });
            });

            // Log centres with no assignments (useful for debugging)
            const centresWithNoAssignments = Array.from(groups.values()).filter(g => g.officers.length === 0).map(g => g.centre.vote_centre_code);
            console.log('Centres with no assignments:', centresWithNoAssignments.length, centresWithNoAssignments.slice(0, 50));

            // Sort officers in each centre: Presiding, then Assistant Presiding, then Polling
            groups.forEach(bundle => {
                bundle.officers.sort((a, b) => {
                    const order = { 'presiding': 1, 'ass_presiding': 2, 'polling': 3 };
                    if (order[a.officer_type] !== order[b.officer_type]) {
                        return order[a.officer_type] - order[b.officer_type];
                    }
                    if (a.booth_number !== b.booth_number) {
                        return (a.booth_number || 0) - (b.booth_number || 0);
                    }
                    return (a.person_number || 0) - (b.person_number || 0);
                });
            });

            const groupsArray = Array.from(groups.values());
            return groupsArray.sort((a, b) => (Number(a.centre.vote_centre_code) || 0) - (Number(b.centre.vote_centre_code) || 0));
        }

        function toBengaliNumber(n) {
            if (n === null || n === undefined) return '';
            const bengaliDigits = '‡ß¶‡ßß‡ß®‡ß©‡ß™‡ß´‡ß¨‡ß≠‡ßÆ‡ßØ';
            return String(n).replace(/\d/g, d => bengaliDigits[Number(d)]);
        }

        function renderMasterRoll(allData) {
            const container = document.getElementById('masterRollContent');
            let html = '';

            allData.forEach((bundle, index) => {
                const { centre } = bundle;

                html += `
                    <div class="page ${index < allData.length - 1 ? 'page-break' : ''}" style="padding: 10px; font-family: 'Nikosh', sans-serif; height: 280mm; box-sizing: border-box; display: block; position: relative;">
                        <!-- Voucher 1: Transport Expenses -->
                        <div class="voucher" style="height: 130mm; position: relative; box-sizing: border-box; padding-top: 10px;">
                            <div style="text-align: right; margin-bottom: 2px; font-size: 10pt;">‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞ ‡¶®‡¶Ç-........................................</div>
                            <div style="text-align: center; margin-bottom: 20px;">
                                <h1 style="font-size: 15pt; text-decoration: underline; display: inline-block; margin: 0;">‡¶§‡ßç‡¶∞‡ßü‡ßã‡¶¶‡¶∂ ‡¶ú‡¶æ‡¶§‡ßÄ‡ßü ‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡ß®‡ß¶‡ß®‡ß¨ ‡¶â‡¶™‡¶≤‡¶ï‡ßç‡¶∑‡ßá ‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞</h1>
                            </div>
                            
                            <div style="font-size: 13pt; line-height: 1.6;">
                                <div>‡ßß‡•§ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡¶ø ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ì ‡¶®‡¶æ‡¶Æ: ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ - ‡ß®‡ß¨‡ß¨ ‡¶´‡ßá‡¶®‡ßÄ-‡ß®</div>
                                <div style="font-weight: bold;">‡ß®‡•§ ‡¶≠‡ßã‡¶ü ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ: ${toBengaliNumber(centre.vote_centre_code)} - ${centre.vote_centre_name || ''}</div>
                                <div>‡ß©‡•§ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ‡ßß‡ß®/‡ß¶‡ß®/‡ß®‡ß¶‡ß®‡ß¨ ‡¶ñ‡ßç‡¶∞‡¶ø.</div>
                                <div style="margin-top: 5px;">‡ß™‡•§ ‡¶Ö‡¶∞‡ßç‡¶•‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£: =‡ß´‡ß¶‡ß¶‡ß¶/- <span style="margin-left: 50px;">(‡¶™‡¶æ‡¶Å‡¶ö ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞)</span></div>
                                <div style="font-size: 10pt; margin-top: -2px; padding-left: 105px;">
                                    <span>(‡¶Ö‡¶Ç‡¶ï‡ßá)</span>
                                    <span style="margin-left: 100px;">(‡¶ï‡¶•‡¶æ‡ßü)</span>
                                </div>
                                <div style="text-align: justify; margin-top: 10px;">
                                    ‡ß´‡•§ ‡¶Ø‡ßá ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶∞‡ßç‡¶• ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶§‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£:  ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡¶ü ‡¶™‡ßá‡¶™‡¶æ‡¶∞, ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶´‡¶∞‡¶Æ, ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü, ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ ‡¶¶‡ßç‡¶∞‡¶¨‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø ‡¶≠‡ßã‡¶ü‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá ‡¶™‡ßç‡¶∞‡ßá‡¶∞‡¶£ ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶∏‡¶Æ‡¶æ‡¶™‡ßç‡¶§‡¶ø‡¶∞ ‡¶™‡¶∞ ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Ö‡¶´‡¶ø‡¶∏‡¶æ‡¶∞/‡¶∏‡¶π‡¶ï‡¶æ‡¶∞‡¶ø ‡¶∞‡¶ø‡¶ü‡¶æ‡¶∞‡ßç‡¶®‡¶ø‡¶Ç ‡¶Ö‡¶´‡¶ø‡¶∏‡¶æ‡¶∞‡ßá‡¶∞ ‡¶®‡¶ø‡¶ï‡¶ü ‡¶´‡ßá‡¶∞‡ßé ‡¶Ü‡¶®‡ßü‡¶® ‡¶¨‡¶æ‡¶¨‡¶¶ (‡¶™‡¶®‡ßç‡¶Ø‡ßá‡¶∞ ‡¶≠‡¶æ‡ßú‡¶æ ‡¶ì ‡¶™‡¶∞‡¶ø‡¶¨‡¶π‡¶® ‡¶¨‡ßç‡¶Ø‡ßü) : ‡ß´‡ß¶‡ß¶‡ß¶/-
                                </div>
                            </div>

                            <div style="position: absolute; bottom: 20px; left: 0; right: 0; overflow: hidden; font-size: 11pt;">
                                <div style="float: left; width: 45%; margin-top: 40px;">
                                    <p style="border-top: 1px solid black; display: inline-block; padding-top: 5px;">‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ<br>(‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶™‡¶¶‡¶¨‡ßÄ ‡¶∏‡¶Æ‡ßç‡¶¨‡¶≤‡¶ø‡¶§ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞)</p>
                                </div>
                                <div style="float: right; width: 50%; text-align: left;">
                                    <p style="margin-left: 20px; margin-bottom: 5px;">‡¶Ö‡¶∞‡ßç‡¶• ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</p>
                                    <p>‡¶®‡¶æ‡¶Æ:................................................................</p>
                                    <p>‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ:.........................................................</p>
                                    <p>‡¶™‡¶¶‡¶¨‡ßÄ: ..............................................................</p>
                                    <p>‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ:...........................................................</p>
                                </div>
                            </div>
                        </div>

                        <div class="separator" style="margin: 5mm 0;"></div>

                        <!-- Voucher 2: Labor Expenses -->
                        <div class="voucher" style="height: 130mm; position: relative; box-sizing: border-box; padding-top: 10px;">
                            <div style="text-align: right; margin-bottom: 2px; font-size: 10pt;">‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞ ‡¶®‡¶Ç-.......................................</div>
                            <div style="text-align: center; margin-bottom: 20px;">
                                <h1 style="font-size: 15pt; text-decoration: underline; display: inline-block; margin: 0;">‡¶§‡ßç‡¶∞‡ßü‡ßã‡¶¶‡¶∂ ‡¶ú‡¶æ‡¶§‡ßÄ‡ßü ‡¶∏‡¶Ç‡¶∏‡¶¶ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡ß®‡ß¶‡ß®‡ß¨ ‡¶â‡¶™‡¶≤‡¶ï‡ßç‡¶∑‡ßá ‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡¶∞‡¶ø‡¶∂‡ßã‡¶ß‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶≠‡¶æ‡¶â‡¶ö‡¶æ‡¶∞</h1>
                            </div>
                            
                            <div style="font-size: 13pt; line-height: 1.6;">
                                <div>‡ßß‡•§ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡¶ø ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ‡¶∞ ‡¶®‡¶Æ‡ßç‡¶¨‡¶∞ ‡¶ì ‡¶®‡¶æ‡¶Æ: ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶®‡ßÄ ‡¶è‡¶≤‡¶æ‡¶ï‡¶æ - ‡ß®‡ß¨‡ß¨ ‡¶´‡ßá‡¶®‡ßÄ-‡ß®</div>
                                <div style="font-weight: bold;">‡ß®‡•§ ‡¶≠‡ßã‡¶ü ‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞‡ßá‡¶∞ ‡¶®‡¶æ‡¶Æ: ${toBengaliNumber(centre.vote_centre_code)} - ${centre.vote_centre_name || ''}</div>
                                <div>‡ß©‡•§ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶Ö‡¶®‡ßÅ‡¶∑‡ßç‡¶†‡¶æ‡¶®‡ßá‡¶∞ ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ: ‡ßß‡ß®/‡ß¶‡ß®/‡ß®‡ß¶‡ß®‡ß¨ ‡¶ñ‡ßç‡¶∞‡¶ø.</div>
                                <div>‡ß™‡•§ ‡¶Ö‡¶∞‡ßç‡¶•‡ßá‡¶∞ ‡¶™‡¶∞‡¶ø‡¶Æ‡¶æ‡¶£: ‡ßß‡ß®‡ß¶‡ß¶/- ( ‡¶è‡¶ï ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ ‡¶¶‡ßÅ‡¶á ‡¶∂‡¶§ ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶Æ‡¶æ‡¶§‡ßç‡¶∞)</div>
                                <div style="text-align: justify; margin-top: 10px;">
                                    ‡ß´‡•§ ‡¶Ø‡ßá ‡¶ï‡¶æ‡¶ú‡ßá‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶Ö‡¶∞‡ßç‡¶• ‡¶¨‡¶∞‡¶æ‡¶¶‡ßç‡¶¶ ‡¶ï‡¶∞‡¶æ ‡¶π‡ßü‡ßá‡¶õ‡ßá ‡¶§‡¶æ‡¶∞ ‡¶¨‡¶ø‡¶¨‡¶∞‡¶£: ‡¶ú‡ßá‡¶≤‡¶æ ‡¶∏‡¶¶‡¶∞ ‡¶π‡¶§‡ßá ‡¶•‡¶æ‡¶®‡¶æ/‡¶â‡¶™‡¶ú‡ßá‡¶≤‡¶æ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶Ö‡¶´‡¶ø‡¶∏‡ßá ‡¶¨‡ßç‡¶Ø‡¶æ‡¶≤‡¶ü ‡¶™‡ßá‡¶™‡¶æ‡¶∞/‡¶á‡¶≠‡¶ø‡¶è‡¶Æ, ‡¶¨‡¶ø‡¶≠‡¶ø‡¶®‡ßç‡¶® ‡¶™‡ßç‡¶∞‡¶ï‡¶æ‡¶∞ ‡¶´‡¶∞‡¶Æ, ‡¶™‡ßç‡¶Ø‡¶æ‡¶ï‡ßá‡¶ü, ‡¶Æ‡ßç‡¶Ø‡¶æ‡¶®‡ßÅ‡ßü‡ßá‡¶≤ ‡¶è‡¶¨‡¶Ç ‡¶Æ‡¶®‡¶ø‡¶π‡¶æ‡¶∞‡ßÄ ‡¶¶‡ßç‡¶∞‡¶¨‡ßç‡¶Ø‡¶æ‡¶¶‡¶ø ‡¶ì ‡¶Ö‡¶®‡ßç‡¶Ø‡¶æ‡¶®‡ßç‡¶Ø ‡¶ú‡¶ø‡¶®‡¶ø‡¶∏‡¶™‡¶§‡ßç‡¶∞ ‡¶®‡ßá‡ßü‡¶æ‡¶∞ ‡¶ú‡¶®‡ßç‡¶Ø ‡¶è‡¶¨‡¶Ç ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶∏‡¶Æ‡¶æ‡¶™‡ßç‡¶§‡¶ø‡¶∞ ‡¶™‡¶∞ ‡¶ú‡ßá‡¶≤‡¶æ ‡¶∏‡¶¶‡¶∞‡ßá ‡¶´‡ßá‡¶∞‡ßé ‡¶Ü‡¶®‡ßü‡¶® ‡¶ñ‡¶∞‡¶ö ‡¶¨‡¶æ‡¶¨‡¶¶ (‡¶ï‡ßá‡¶®‡ßç‡¶¶‡ßç‡¶∞ ‡¶™‡ßç‡¶∞‡¶§‡¶ø ‡ßß,‡ß®‡ß¶‡ß¶/- ‡¶ü‡¶æ‡¶ï‡¶æ ‡¶π‡¶æ‡¶∞‡ßá, ‡¶≤‡ßã‡¶°-‡ß¨‡ß¶‡ß¶/-, ‡¶Ü‡¶®‡¶≤‡ßã‡¶°-‡ß¨‡ß¶‡ß¶/-)  {‡¶∂‡ßç‡¶∞‡¶Æ‡¶ø‡¶ï (‡¶Ö‡¶®‡¶ø‡ßü‡¶Æ‡¶ø‡¶§) ‡¶Æ‡ßÅ‡¶ú‡ßÅ‡¶∞‡ßÄ} : ‡ßß‡ß®‡ß¶‡ß¶/-
                                </div>
                            </div>

                            <div style="position: absolute; bottom: 20px; left: 0; right: 0; overflow: hidden; font-size: 11pt;">
                                <div style="float: left; width: 45%; margin-top: 40px;">
                                    <p style="border-top: 1px solid black; display: inline-block; padding-top: 5px;">‡¶Ö‡¶∞‡ßç‡¶• ‡¶™‡ßç‡¶∞‡¶¶‡¶æ‡¶®‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ<br>(‡¶®‡¶æ‡¶Æ ‡¶ì ‡¶™‡¶¶‡¶¨‡ßÄ ‡¶∏‡¶Æ‡ßç‡¶¨‡¶≤‡¶ø‡¶§ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞)</p>
                                </div>
                                <div style="float: right; width: 50%; text-align: left;">
                                    <p style="margin-left: 20px; margin-bottom: 5px;">‡¶Ö‡¶∞‡ßç‡¶• ‡¶ó‡ßç‡¶∞‡¶π‡¶£‡¶ï‡¶æ‡¶∞‡ßÄ‡¶∞ ‡¶∏‡ßç‡¶¨‡¶æ‡¶ï‡ßç‡¶∑‡¶∞ ‡¶ì ‡¶§‡¶æ‡¶∞‡¶ø‡¶ñ:</p>
                                    <p>‡¶®‡¶æ‡¶Æ:................................................................</p>
                                    <p>‡¶™‡¶ø‡¶§‡¶æ‡¶∞ ‡¶®‡¶æ‡¶Æ:.........................................................</p>
                                    <p>‡¶™‡¶¶‡¶¨‡ßÄ: ..............................................................</p>
                                    <p>‡¶™‡ßÇ‡¶∞‡ßç‡¶£ ‡¶†‡¶ø‡¶ï‡¶æ‡¶®‡¶æ:...........................................................</p>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            });

            container.innerHTML = html;
        }

        function convertNumberToBanglaWords(amount) {
            const words = {
                0: '', 1: '‡¶è‡¶ï', 2: '‡¶¶‡ßÅ‡¶á', 3: '‡¶§‡¶ø‡¶®', 4: '‡¶ö‡¶æ‡¶∞', 5: '‡¶™‡¶æ‡¶Å‡¶ö', 6: '‡¶õ‡ßü', 7: '‡¶∏‡¶æ‡¶§', 8: '‡¶Ü‡¶ü', 9: '‡¶®‡ßü', 10: '‡¶¶‡¶∂',
                11: '‡¶è‡¶ó‡¶æ‡¶∞‡ßã', 12: '‡¶¨‡¶æ‡¶∞‡ßã', 13: '‡¶§‡ßá‡¶∞‡ßã', 14: '‡¶ö‡ßå‡¶¶‡ßç‡¶¶', 15: '‡¶™‡¶®‡ßá‡¶∞‡ßã', 16: '‡¶∑‡ßã‡¶≤', 17: '‡¶∏‡¶§‡ßá‡¶∞‡ßã', 18: '‡¶Ü‡¶†‡¶æ‡¶∞‡ßã', 19: '‡¶ä‡¶®‡¶ø‡¶∂', 20: '‡¶¨‡¶ø‡¶∂',
                21: '‡¶è‡¶ï‡ßÅ‡¶∂', 22: '‡¶¨‡¶æ‡¶á‡¶∂', 23: '‡¶§‡ßá‡¶á‡¶∂', 24: '‡¶ö‡¶¨‡ßç‡¶¨‡¶ø‡¶∂', 25: '‡¶™‡¶Å‡¶ö‡¶ø‡¶∂', 26: '‡¶õ‡¶æ‡¶¨‡ßç‡¶¨‡¶ø‡¶∂', 27: '‡¶æ‡¶§‡¶æ‡¶∂', 28: '‡¶Ü‡¶†‡¶æ‡¶∂', 29: '‡¶ä‡¶®‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 30: '‡¶§‡ßç‡¶∞‡¶ø‡¶∂',
                31: '‡¶è‡¶ï‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 32: '‡¶¨‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 33: '‡¶§‡ßá‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 34: '‡¶ö‡ßå‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 35: '‡¶™‡ßü‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 36: '‡¶õ‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 37: '‡¶∏‡¶æ‡¶Å‡¶á‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 38: '‡¶Ü‡¶ü‡¶§‡ßç‡¶∞‡¶ø‡¶∂', 39: '‡¶ä‡¶®‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 40: '‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂',
                41: '‡¶è‡¶ï‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 42: '‡¶¨‡¶ø‡ßü‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 43: '‡¶§‡ßá‡¶§‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 44: '‡¶ö‡ßÅ‡ßü‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 45: '‡¶™‡ßü‡¶§‡¶æ‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 46: '‡¶õ‡ßá‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 47: '‡¶∏‡¶æ‡¶§‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 48: '‡¶Ü‡¶ü‡¶ö‡¶≤‡ßç‡¶≤‡¶ø‡¶∂', 49: '‡¶ä‡¶®‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂', 50: '‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶∂',
                51: '‡¶è‡¶ï‡¶æ‡¶®‡ßç‡¶®', 52: '‡¶¨‡¶æ‡ßü‡¶æ‡¶®‡ßç‡¶®', 53: '‡¶§‡¶ø‡¶™‡ßç‡¶™‡¶æ‡¶®‡ßç‡¶®', 54: '‡¶ö‡ßÅ‡ßü‡¶æ‡¶®‡ßç‡¶®', 55: '‡¶™‡¶û‡ßç‡¶ö‡¶æ‡¶®‡ßç‡¶®', 56: '‡¶õ‡¶æ‡¶™‡ßç‡¶™‡¶æ‡¶®‡ßç‡¶®', 57: '‡¶∏‡¶æ‡¶§‡¶æ‡¶®‡ßç‡¶®', 58: '‡¶Ü‡¶ü‡¶æ‡¶®‡ßç‡¶®', 59: '‡¶ä‡¶®‡¶∑‡¶æ‡¶ü', 60: '‡¶∑‡¶æ‡¶ü',
                61: '‡¶è‡¶ï‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 62: '‡¶¨‡¶æ‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 63: '‡¶§‡ßá‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 64: '‡¶ö‡ßå‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 65: '‡¶™‡ßü‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 66: '‡¶õ‡ßá‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 67: '‡¶∏‡¶æ‡¶§‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 68: '‡¶Ü‡¶ü‡¶∑‡¶ü‡ßç‡¶ü‡¶ø', 69: '‡¶ä‡¶®‡¶∏‡¶§‡ßç‡¶§‡¶∞', 70: '‡¶∏‡¶§‡ßç‡¶§‡¶∞',
                71: '‡¶è‡¶ï‡¶æ‡¶§‡ßç‡¶§‡¶∞', 72: '‡¶¨‡¶æ‡¶π‡¶æ‡¶§‡ßç‡¶§‡¶∞', 73: '‡¶§‡¶ø‡ßü‡¶æ‡¶§‡ßç‡¶§‡¶∞', 74: '‡¶ö‡ßÅ‡ßü‡¶æ‡¶§‡ßç‡¶§‡¶∞', 75: '‡¶™‡¶Å‡¶ö‡¶æ‡¶§‡ßç‡¶§‡¶∞', 76: '‡¶õ‡¶ø‡ßü‡¶æ‡¶§‡ßç‡¶§‡¶∞', 77: '‡¶∏‡¶æ‡¶§‡¶æ‡¶§‡ßç‡¶§‡¶∞', 78: '‡¶Ü‡¶ü‡¶æ‡¶§‡ßç‡¶§‡¶∞', 79: '‡¶ä‡¶®‡¶Ü‡¶∂‡¶ø', 80: '‡¶Ü‡¶∂‡¶ø',
                81: '‡¶è‡¶ï‡¶æ‡¶∂‡¶ø', 82: '‡¶¨‡¶ø‡¶∞‡¶æ‡¶∂‡¶ø', 83: '‡¶§‡¶ø‡¶∞‡¶æ‡¶∂‡¶ø', 84: '‡¶ö‡ßÅ‡¶∞‡¶æ‡¶∂‡¶ø', 85: '‡¶™‡¶Å‡¶ö‡¶æ‡¶∂‡¶ø', 86: '‡¶õ‡¶ø‡ßü‡¶æ‡¶∂‡¶ø', 87: '‡¶∏‡¶æ‡¶§‡¶æ‡¶∂‡¶ø', 88: '‡¶Ü‡¶ü‡¶æ‡¶∂‡¶ø', 89: '‡¶ä‡¶®‡¶®‡¶¨‡ßç‡¶¨‡¶á', 90: '‡¶®‡¶¨‡ßç‡¶¨‡¶á',
                91: '‡¶è‡¶ï‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 92: '‡¶¨‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 93: '‡¶§‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 94: '‡¶ö‡ßÅ‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 95: '‡¶™‡¶Å‡¶ö‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 96: '‡¶õ‡¶ø‡ßü‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 97: '‡¶∏‡¶æ‡¶§‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 98: '‡¶Ü‡¶ü‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á', 99: '‡¶®‡¶ø‡¶∞‡¶æ‡¶®‡¶¨‡ßç‡¶¨‡¶á'
            };

            const convert = (n) => {
                n = Number(n);
                if (n === 0) return '';
                if (n < 100) return words[n];
                if (n < 1000) {
                    const hundreds = Math.floor(n / 100);
                    const remainder = n % 100;
                    return (hundreds ? words[hundreds] + ' ‡¶∂‡¶§ ' : '') + (remainder ? convert(remainder) : '');
                }
                if (n < 100000) {
                    const thousands = Math.floor(n / 1000);
                    const remainder = n % 1000;
                    return (thousands ? convert(thousands) + ' ‡¶π‡¶æ‡¶ú‡¶æ‡¶∞ ' : '') + (remainder ? convert(remainder) : '');
                }
                if (n < 10000000) {
                    const lakhs = Math.floor(n / 100000);
                    const remainder = n % 100000;
                    return (lakhs ? convert(lakhs) + ' ‡¶≤‡¶ï‡ßç‡¶∑ ' : '') + (remainder ? convert(remainder) : '');
                }
                const crores = Math.floor(n / 10000000);
                const remainder = n % 10000000;
                return (crores ? convert(crores) + ' ‡¶ï‡ßã‡¶ü‡¶ø ' : '') + (remainder ? convert(remainder) : '');
            };
            return convert(amount).trim();
        }
    </script>
</body>

</html>