# ржжрж╛ржпрж╝рж┐рждрзНржм ржмржирзНржЯржи ржЬрзЗржирж╛рж░рзЗржЯрж░ - ржмрзНржпржмрж╣рж╛рж░ржмрж┐ржзрж┐

## ЁЯУЛ рж╕ржВржХрзНрж╖рж┐ржкрзНржд ржмрж┐ржмрж░ржг

ржПржЗ рж╕рж┐рж╕рзНржЯрзЗржо ржнрзЛржЯ ржХрзЗржирзНржжрзНрж░рзЗ ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ, рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржПржмржВ ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░ржжрзЗрж░ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржжрж╛ржпрж╝рж┐рждрзНржм ржмржирзНржЯржи ржХрж░рзЗред рж▓рж┐ржЩрзНржЧ ржнрж┐рждрзНрждрж┐ржХ рж╕ржорж╛ржи ржмржирзНржЯржи ржПржмржВ ржПрж▓рзЛржорзЗрж▓рзЛ (random) ржирж┐рж░рзНржмрж╛ржЪржи ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рж╛ рж╣ржпрж╝ред request_table ржерзЗржХрзЗ рж╕ржмрж╛ржЗржХрзЗ ржПрж╕рж╛ржЗржи ржХрж░ржмрзЗред disability = 'Yes'` ржерж╛ржХрж▓рзЗ рж╕рзЗржЗ ржмрзНржпржХрзНрждрж┐ржХрзЗ ржмрж╛ржж ржжрзЗржУржпрж╝рж╛ рж╣ржмрзЗ

## ЁЯОп ржорзВрж▓ ржмрзИрж╢рж┐рж╖рзНржЯрзНржп

logic-1
### тЬЕ рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ ржжрж╛ржпрж╝рж┐рждрзНржм ржмржирзНржЯржи
- ржкрзНрж░рждрж┐ржЯрж┐ ржнрзЛржЯ ржХрзЗржирзНржжрзНрж░рзЗ ржПржХржЬржи ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░
- ржмрзБрже рж╕ржВржЦрзНржпрж╛ ржЕржирзБржпрж╛ржпрж╝рзА рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░
- ржкрзНрж░рждрж┐ржЯрж┐ ржмрзБржерзЗ ржжрзБржЗржЬржи ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░
- ржкрзНрж░рждрж┐ ржХрзЗржирзНржжрзНрж░рзЗ рж╕ржорж╛ржи рж╕ржВржЦрзНржпржХ ржирж╛рж░рзА, ржкрзБрж░рж╖ рж╕рж╣-ржкрзНрж░рж┐ржЬрж╛ржЗржбрж┐ржВ ржУ ржкрзЛрж▓рж┐ржВ ржерж╛ржХржмрзЗ (рзлрзж-рзлрзж ржХрж░рж╛рж░ ржЪрзЗрж╖рзНржЯрж╛ ржХрж░ржмрзЗ / ржорзЛржЯ ржирж╛рж░рзА ржУ ржкрзБрж░рзБрж╖ржХрзЗ ржнрж╛ржЧ ржХрж░рзЗ ржХрзЗржирзНржжрзНрж░рзЗ ржПрж╕рж╛ржЗржи ржХрж░ржмрзЗред)
- рззржо рж╕рж╣-ржкрзНрж░рж┐ржЬрж╛ржЗржбрж┐ржВ рж╕ржм рж╕ржорзЯ "Male" рж╣ржмрзЗред

logic-2
### ЁЯЪл ржкрзНрж░рждрж┐ржмржирзНржзрзА ржмрзНржпржХрзНрждрж┐ржжрзЗрж░ ржмрж╛ржж ржжрзЗржУржпрж╝рж╛
- `disability = 'Yes'` ржерж╛ржХрж▓рзЗ рж╕рзЗржЗ ржмрзНржпржХрзНрждрж┐ржХрзЗ ржмрж╛ржж ржжрзЗржУржпрж╝рж╛ рж╣ржпрж╝
- рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝

logic-3
### ЁЯЪл "request_table ржерзЗржХрзЗ рж╕ржмрж╛ржЗржХрзЗ ржПрж╕рж╛ржЗржи ржХрж░ржмрзЗред"
- `disability = 'Yes'` ржерж╛ржХрж▓рзЗ рж╕рзЗржЗ ржмрзНржпржХрзНрждрж┐ржХрзЗ ржмрж╛ржж ржжрзЗржУржпрж╝рж╛ рж╣ржмрзЗ
- рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржлрж┐рж▓рзНржЯрж╛рж░ рж╣ржпрж╝рзЗ ржпрж╛ржпрж╝

logic-4
### ЁЯО▓ ржПрж▓рзЛржорзЗрж▓рзЛ ржирж┐рж░рзНржмрж╛ржЪржи
- Fisher-Yates Shuffle Algorithm ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЗ рж╕ржорзНржкрзВрж░рзНржг random ржмржирзНржЯржи
- ржкрзНрж░рждрж┐ржмрж╛рж░ ржирждрзБржи ржХрж░рзЗ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рж▓рзЗ ржнрж┐ржирзНржи ржлрж▓рж╛ржлрж▓

logic-5
### тЪЦя╕П рж▓рж┐ржЩрзНржЧ ржнрж┐рждрзНрждрж┐ржХ рж╕ржорж╛ржи ржмржирзНржЯржи
- Male, Female, Unknown рж╕ржорж╛ржиржнрж╛ржмрзЗ ржмржирзНржЯржи
- рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржПржмржВ ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░ржжрзЗрж░ ржХрзНрж╖рзЗрждрзНрж░рзЗ ржкрзНрж░ржпрзЛржЬрзНржп
- Male, Female, Unknown ржпрзЗрж╣рзЗрждрзБ рж╕ржоржнрж╛ржмрзЗ ржирзЗржЗ рждрж╛ржЗ, ржлрж╛ржБржХрж╛ ржЧрзБрж▓рзЛ рж░рзЗржиржбржо ржПрж╕рж╛ржЗржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗред 


### ЁЯТ╛ ржбрзЗржЯрж╛ржмрзЗрж╕ рж╕ржВрж░ржХрзНрж╖ржг
- `centre_assignments` ржЯрзЗржмрж┐рж▓рзЗ рж╕ржм ржПрж╕рж╛ржЗржиржорзЗржирзНржЯ рж╕рзЗржн рж╣ржпрж╝
- рждрж┐ржиржЯрж┐ ржЯрзЗржмрж┐рж▓рзЗ `assign_code` ржЖржкржбрзЗржЯ рж╣ржпрж╝:
  - `presiding_list` тЖТ assign_code = `{centre_iid}`
  - `ass_presiding_list` тЖТ assign_code = `{centre_iid}-{booth}`
  - `polling_list` тЖТ assign_code = `{centre_iid}-{booth}-{person}`

## ЁЯУК ржбрзЗржЯрж╛ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░

### Vote Centre (vote_centre)
```
- vote_centre_iid (Primary Key)
- vote_centre_code
- vote_centre_name
- voter_both_total (ржмрзБрже рж╕ржВржЦрзНржпрж╛)
```

### Presiding List (presiding_list)
```
- presiding_iid (Primary Key)
- name
- designation
- disability
- assign_code
```

### Assistant Presiding List (ass_presiding_list)
```
- ass_presiding_iid (Primary Key)
- name
- designation
- gender
- disability
- assign_code
```

### Polling List (polling_list)
```
- polling_iid (Primary Key)
- name
- designation
- gender
- disability
- assign_code
```

### Centre Assignments (centre_assignments)
```
- assignment_id (Primary Key)
- vote_centre_iid
- vote_centre_code
- officer_type ('presiding', 'ass_presiding', 'polling')
- officer_iid
- officer_name
- officer_designation
- officer_gender
- booth_number
- person_number
- assign_code
- created_at
- updated_at
```

## ЁЯЪА ржмрзНржпржмрж╣рж╛рж░ ржкржжрзНржзрждрж┐

### рзз. ржкрзЗржЬ ржУржкрзЗржи ржХрж░рзБржи
`generate/2_centre_edit.html` ржлрж╛ржЗрж▓ржЯрж┐ ржмрзНрж░рж╛ржЙржЬрж╛рж░рзЗ ржЦрзБрж▓рзБржиред

### рзи. ржЬрзЗржирж╛рж░рзЗржЯ ржмрж╛ржЯржи ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- "тЪб ржжрж╛ржпрж╝рж┐рждрзНржм ржмржирзНржЯржи ржХрж░рзБржи" ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- рж╕рж┐рж╕рзНржЯрзЗржо рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ рж╕ржм ржбрзЗржЯрж╛ рж▓рзЛржб ржХрж░ржмрзЗ
- ржПрж▓рзЛржорзЗрж▓рзЛ ржХрж░рзЗ ржжрж╛ржпрж╝рж┐рждрзНржм ржмржирзНржЯржи ржХрж░ржмрзЗ
- ржкрзНрж░рждрж┐ржЯрж┐ ржХрзЗржирзНржжрзНрж░рзЗрж░ ржЬржирзНржп ржЖрж▓рж╛ржжрж╛ ржХрж╛рж░рзНржб ржжрзЗржЦрж╛ржмрзЗ

### рзй. ржлрж▓рж╛ржлрж▓ ржжрзЗржЦрзБржи
- ржкрзНрж░рждрж┐ржЯрж┐ ржХрзЗржирзНржжрзНрж░рзЗрж░ ржЬржирзНржп:
  - ржХрзЗржирзНржжрзНрж░ ржиржорзНржмрж░ ржУ ржирж╛ржо
  - ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░
  - рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ (ржмрзБрже ржЕржирзБржпрж╛ржпрж╝рзА)
  - ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░ (ржкрзНрж░рждрж┐ ржмрзБржерзЗ ржжрзБржЗржЬржи)
  - ржмрж┐ржХрж▓рзНржк ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░

### рзк. рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи
- "ЁЯТ╛ рж╕ржВрж░ржХрзНрж╖ржг ржХрж░рзБржи" ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- ржХржиржлрж╛рж░рзНржо ржХрж░рзБржи
- ржбрзЗржЯрж╛ржмрзЗрж╕рзЗ рж╕ржм рждржерзНржп рж╕рзЗржн рж╣ржмрзЗ
- `assign_code` ржЖржкржбрзЗржЯ рж╣ржмрзЗ

### рзл. ржкрзНрж░рж┐ржирзНржЯ ржХрж░рзБржи
- "ЁЯЦия╕П ржкрзНрж░рж┐ржирзНржЯ ржХрж░рзБржи" ржмрж╛ржЯржирзЗ ржХрзНрж▓рж┐ржХ ржХрж░рзБржи
- ржкрзНрж░рждрж┐ржЯрж┐ ржХрзЗржирзНржжрзНрж░ ржЖрж▓рж╛ржжрж╛ ржкрзЗржЬрзЗ ржкрзНрж░рж┐ржирзНржЯ рж╣ржмрзЗ

## ЁЯФН ржПрж▓ржЧрж░рж┐ржжржо ржмрж┐рж╕рзНрждрж╛рж░рж┐ржд

### ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржирж┐рж░рзНржмрж╛ржЪржи
```javascript
1. presiding_list ржерзЗржХрзЗ рж╕ржм ржбрзЗржЯрж╛ рж▓рзЛржб
2. disability = 'yes' ржмрж╛ржж ржжрж╛ржУ
3. assign_code = null ржмрж╛ржж ржжрж╛ржУ (ржЖржЧрзЗ ржПрж╕рж╛ржЗржи ржХрж░рж╛)
4. рж╕ржм ржбрзЗржЯрж╛ shuffle ржХрж░рзЛ
5. ржкрзНрж░рждрж┐ржЯрж┐ ржХрзЗржирзНржжрзНрж░рзЗ ржПржХржЬржи ржХрж░рзЗ assign ржХрж░рзЛ
```

### рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржирж┐рж░рзНржмрж╛ржЪржи
```javascript
1. ass_presiding_list ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб
2. disability = 'yes' ржПржмржВ assign_code != null ржмрж╛ржж ржжрж╛ржУ
3. Male, Female, Unknown ржЖрж▓рж╛ржжрж╛ ржХрж░рзЛ
4. ржкрзНрж░рждрж┐ржЯрж┐ ржЧрзНрж░рзБржк shuffle ржХрж░рзЛ
5. рж╕ржорж╛ржи рж╕ржВржЦрзНржпржХ ржирж┐рждрзЗ round-robin ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ
6. voter_both_total рж╕ржВржЦрзНржпржХ assign ржХрж░рзЛ
```

### ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржирж┐рж░рзНржмрж╛ржЪржи
```javascript
1. polling_list ржерзЗржХрзЗ ржбрзЗржЯрж╛ рж▓рзЛржб
2. disability = 'yes' ржПржмржВ assign_code != null ржмрж╛ржж ржжрж╛ржУ
3. Male, Female, Unknown ржЖрж▓рж╛ржжрж╛ ржХрж░рзЛ
4. ржкрзНрж░рждрж┐ржЯрж┐ ржЧрзНрж░рзБржк shuffle ржХрж░рзЛ
5. рж╕ржорж╛ржи рж╕ржВржЦрзНржпржХ ржирж┐рждрзЗ round-robin ржкржжрзНржзрждрж┐ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзЛ
6. (voter_both_total ├Ч 2) рж╕ржВржЦрзНржпржХ assign ржХрж░рзЛ
```

## ЁЯУИ ржкрж░рж┐рж╕ржВржЦрзНржпрж╛ржи

рж╕рж┐рж╕рзНржЯрзЗржо рж╕рзНржмржпрж╝ржВржХрзНрж░рж┐ржпрж╝ржнрж╛ржмрзЗ ржжрзЗржЦрж╛ржмрзЗ:
- ржорзЛржЯ ржХрзЗржирзНржжрзНрж░ рж╕ржВржЦрзНржпрж╛
- ржорзЛржЯ ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░
- ржорзЛржЯ рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░
- ржорзЛржЯ ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░

## тЪая╕П ржЧрзБрж░рзБрждрзНржмржкрзВрж░рзНржг ржирзЛржЯ

1. **ржПржХржмрж╛рж░ рж╕рзЗржн ржХрж░рж▓рзЗ ржкрзБржирж░рж╛ржпрж╝ ржЬрзЗржирж╛рж░рзЗржЯ ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи ржирж╛** (ржПржХржЗ ржмрзНржпржХрзНрждрж┐ ржжрзБржЗржмрж╛рж░ assign рж╣ржмрзЗ ржирж╛)
2. **ржпржерзЗрж╖рзНржЯ ржЕржлрж┐рж╕рж╛рж░ ржЖржЫрзЗ ржХрж┐ржирж╛ ржирж┐рж╢рзНржЪрж┐ржд ржХрж░рзБржи**:
   - ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ: ржХрзЗржирзНржжрзНрж░ рж╕ржВржЦрзНржпрж╛рж░ рж╕ржорж╛ржи
   - рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ: ржорзЛржЯ ржмрзБрже рж╕ржВржЦрзНржпрж╛рж░ рж╕ржорж╛ржи
   - ржкрзЛрж▓рж┐ржВ: ржорзЛржЯ ржмрзБрже рж╕ржВржЦрзНржпрж╛рж░ ржжрзНржмрж┐ржЧрзБржг
3. **authentication.js ржкрзНрж░ржпрж╝рзЛржЬржи** - рж▓ржЧржЗржи ржЫрж╛ржбрж╝рж╛ ржХрж╛ржЬ ржХрж░ржмрзЗ ржирж╛
4. **Supabase рж╕ржВржпрзЛржЧ ржкрзНрж░ржпрж╝рзЛржЬржи** - ржбрзЗржЯрж╛ржмрзЗрж╕ ржЕрзНржпрж╛ржХрзНрж╕рзЗрж╕рзЗрж░ ржЬржирзНржп

## ЁЯЫая╕П рждрзНрж░рзБржЯрж┐ рж╕ржорж╛ржзрж╛ржи

### "ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ рж╢рзЗрж╖ рж╣ржпрж╝рзЗ ржЧрзЗржЫрзЗ"
- ржЖрж░рзЛ ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржпрзЛржЧ ржХрж░рзБржи `presiding_list` ржЯрзЗржмрж┐рж▓рзЗ

### "рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржпржерзЗрж╖рзНржЯ ржирзЗржЗ"
- ржЖрж░рзЛ рж╕рж╣ржХрж╛рж░рзА ржкрзНрж░рж┐рж╕рж╛ржЗржбрж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржпрзЛржЧ ржХрж░рзБржи `ass_presiding_list` ржЯрзЗржмрж┐рж▓рзЗ

### "ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржпржерзЗрж╖рзНржЯ ржирзЗржЗ"
- ржЖрж░рзЛ ржкрзЛрж▓рж┐ржВ ржЕржлрж┐рж╕рж╛рж░ ржпрзЛржЧ ржХрж░рзБржи `polling_list` ржЯрзЗржмрж┐рж▓рзЗ

### ржбрзЗржЯрж╛ржмрзЗрж╕ рждрзНрж░рзБржЯрж┐
- Supabase рж╕ржВржпрзЛржЧ ржЪрзЗржХ ржХрж░рзБржи
- ржЯрзЗржмрж┐рж▓ рж╕рзНржЯрзНрж░рж╛ржХржЪрж╛рж░ рж╕ржарж┐ржХ ржЖржЫрзЗ ржХрж┐ржирж╛ ржжрзЗржЦрзБржи
- `centre_assignments` ржЯрзЗржмрж┐рж▓ рждрзИрж░рж┐ ржХрж░рзБржи (SQL ржлрж╛ржЗрж▓ ржмрзНржпржмрж╣рж╛рж░ ржХрж░рзБржи)

## ЁЯУЭ SQL ржХрзЛржпрж╝рзЗрж░рж┐ ржЙржжрж╛рж╣рж░ржг

### ржПржХржЯрж┐ ржХрзЗржирзНржжрзНрж░рзЗрж░ рж╕ржм ржжрж╛ржпрж╝рж┐рждрзНржм ржжрзЗржЦрж╛
```sql
SELECT * FROM centre_assignments 
WHERE vote_centre_iid = 1 
ORDER BY officer_type, booth_number;
```

### ржПржХржЬржи ржЕржлрж┐рж╕рж╛рж░ ржХрзЛржерж╛ржпрж╝ ржПрж╕рж╛ржЗржи рж╣ржпрж╝рзЗржЫрзЗ
```sql
SELECT * FROM centre_assignments 
WHERE officer_name = 'ржирж╛ржо';
```

### рж▓рж┐ржЩрзНржЧ ржнрж┐рждрзНрждрж┐ржХ ржкрж░рж┐рж╕ржВржЦрзНржпрж╛ржи
```sql
SELECT officer_type, officer_gender, COUNT(*) as total 
FROM centre_assignments 
WHERE officer_gender IS NOT NULL 
GROUP BY officer_type, officer_gender 
ORDER BY officer_type, officer_gender;
```

## ЁЯФТ ржирж┐рж░рж╛ржкрждрзНрждрж╛

- Authentication рж╕рж┐рж╕рзНржЯрзЗржо ржмрзНржпржмрж╣рж╛рж░ ржХрж░рж╛ рж╣ржпрж╝рзЗржЫрзЗ
- Supabase Row Level Security (RLS) рж╕ржХрзНрж░рж┐ржпрж╝ ржХрж░рзБржи
- рж╢рзБржзрзБржорж╛рждрзНрж░ ржЕржирзБржорзЛржжрж┐ржд ржмрзНржпржХрзНрждрж┐рж░рж╛ ржбрзЗржЯрж╛ ржкрж░рж┐ржмрж░рзНрждржи ржХрж░рждрзЗ ржкрж╛рж░ржмрзЗржи

